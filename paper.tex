\documentclass{llncs}
\usepackage{graphics}
\usepackage{amssymb}
\usepackage[dvips]{epsfig}
\usepackage[latin1]{inputenc}

\def\CC{{C\hspace{-.05em}\raisebox{.4ex}{\tiny\bf ++}}~}
\addtolength{\textfloatsep}{-0.5cm}
\addtolength{\intextsep}{-0.5cm}


%%%%%%%%%%%%%%%% Titulo %%%%%%%%%%%%%%%
\title{Predicting sales of newly published books} 

%%%%%%%%%%%%%%%% autores %%%%%%%%%%%%%%%
\author {
P.A. Castillo, A.M. Mora, J.J. Merelo,  et al.
}
\institute{Department of Architecture and Computer Technology. CITIC \\
           University of Granada (Spain) \\
~\\
           e-mail: {\tt pacv@ugr.es}}

\date{} 

\begin{document}
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}

%% Many companies must face, as one of the most difficult tasks to
%% accomplish, new product sales estimation, since in many cases no
%% historical data to serve as guide is available. 
%% Moreover, some of them lack the knowledge about forecasting methods
%% and they can only make decisions based on the expert sales
  %% managers. 
% Eliminado esto.
When a new book is published the publishing house faces the problem of
how many books should be printed. Printing too many is the main issue,
since it implies a loss of investment due to inventory excess. That is
why in this paper we are tackling the problem or predicting sales to 
print the right amount of books, doing so even before the book has
reached shelves, which is when printing occurs. 
%Thus, making inaccurate predictions may lead to erroneous decisions that result in excess production that will not be sold, or even to a production deficit.
%That is the publishing roll problem, in which publishing companies must estimate the number of volumes printed, taking care not to print more than they actually end up selling. Thus, an automatic prediction of book sales to estimate the publishing roll would be helpful for publishers.
% In the literature, different methods of sales prediction, mainly for
% the fashion industry are proposed. 
% Esto no pega nada en el abstract - JJ
%In these works, when sales are stable with a clear trend over time, the classical methods are a good choice. 
%However, in the case of new products, such as a new book publishing, classical methods do not work properly.
%In this paper, a rule-based decision method is proposed to address the
%problem of predicting the publishing roll.  
% It's not proposed. It just obtained the best result with WEKA. - JJ 
% Publishing roll? ¿Qué es? - JJ
In this paper, which works with data on published books for several years in Spain, we
first apply a data visualization and preprocessing strategy to find
out what are the relevant variables in the prediction of sales, and
then use standard data mining software to predict sales, and from them
deduce print roll, based on those variables. Our work discovers which
are the most relevant variables when predicting sales, and is
eventually able to predict sales with remarkable accuracy. In fact,
this method has been validated by the company that provided the data 
and incorporated in a business intelligence tool for publishing houses,
since the obtained models provide information on the decision process and
does not require human intervention either for the operation or for
interpretation.
\end{abstract}


%********************************************************************************
\section{Introduction}

% A partir de datos históricos de tiradas editoriales se plantea el
% uso de varios modelos para la clasificación y predicción de la
% tirada de nuevos títulos editoriales. 

A company that intends to release a new product has a high risk due to
the complexity of the production and distribution processes. A newly
% tienes que enmarcar el problema. Se trata de productos culturales
% con soporte físico y con ventas relativamente pequeñas. Libros,
% discos, no sé si alguna cosa más. - JJ
launched product is also new to the company, and sales forecasts can
only be based on the experience of similar products. 
In this scope, having accurate estimates of future sales of the new
product is extremely important \cite{ChingChin2010} so that production
runs do not exceed predicted sales. 
Indeed, several studies have demonstrated that improving sale predictions 
(a reduction of forecasting errors) results in an improvement in the 
production \cite{Bayraktar2008,Fildes2010,Saeed2008,Zhao2002}.

% In this sense, the publishing industry is based on very particular and
% established production process, and publishing a book requires several
% steps, between which the distribution is important and plays an
% important role. The publishing process and individual decisions at each step are very
% important. One of those decisions is the number of copies to print. 
  % ¿Esto que tiene que ver con la frase anterior? - JJ
% Thus, a suitable prediction system for new books should take into
% account many details about how the editorial process works. % y? - JJ

% Implementing a good forecasting tool requires not only a good study of
% the state of the art in this field, but also an accurate knowledge of
% the operations and challenges facing the publishing industry and its
% supply chain. % ¿eso es lo que vamos a hacer? - JJ


In the field of publishing industry, the challenge is to print an
adequate number of copies but not too much, as the unsold volumes will
lead to losses, whereas if the number of printed copies was not
enough, you can always print more. 
Thus, it is extremely important using predictive tools to optimize 
production and improve the publishing company profits or minimize losses \cite{Zhao2001}
by forecasting the sales a new book might achieve. 
An example is the optimization of sales \cite{Mattila2002} by
improving profit margins by selling the whole publishing roll.  
% [Pedro] "publishing roll" es como he encontrado "tirada editorial" traducido...

However, accurately using a predictive tool is a difficult task as
book sales are influenced by various factors that make
them fluctuate and usually they might be not controllable and
sometimes unknown. 
Some have to do with decisions on purchases, others with freight
traffic, and others with the distribution strategy \cite{Little1998}. 

Thus, it is very important to know the product and the variables that
might affect the sales, and how an expert manager can eventually 
take them into account \cite{Armstrong2001,SThomassey2014}. 
                                % ¿Esto también pasa en la industria de la
                                % moda. ¿Qué vamos a usar de esto? - JJ
                                % [Pedro] esto iba referido a la Industria Editorial.
Their impact is difficult to estimate and it is not constant over time, 
hence the difficulty to adequately identify and measure their influence \cite{DeToni2000}.
In addition, some may have correlations between them. 
However, these correlations can be detected using data analysis methods, 
such as Self-Organizing Maps (SOM) \cite{kohonen1998} 
or stepwise regression analysis (SRA) \cite{Chang2009}. % What do they
                                % do? What are the results?

In this research, the problem of how many books should be printed 
when a new book is published is faced using data provided by the 
Spanish publishing company Trevenque Editorial \footnote{{\tt http://editorial.trevenque.es}}.
The company's expert sales managers analized historical data 
and applied their knowledge using external variables to calculate
appropriate predictions, for example, increasing or decreasing the 
sales prediction based on season or sales period.
                        % varias citas - JJ
                        % [Pedro] lo modifico para comentar quienes nos facilitaron los datos
                        %  y que así era como funcionaban hasta ese momento.

%In any case, in general companies usually use a forecasting model and then, an expert applies his knowledge, as the company might require an interpretable and understandable model. 

However, carrying out the analysis and forecasting process as described,
may lead to an imprecise analysis and may not take all the variables into account. 
In addition, the process might be tedious, especially when the amount
of data is large, and even, different experts can reach different
predictions from the same data set \cite{ChingChin2010,Sanders1994}.

For these reasons, the industry requires the best suited forecasting
techniques to be adopted so that, estimating sales task is carried out
properly and in an automatic way. 

With this in mind, i this paper a data visualization and preprocessing strategy to find
out what are the relevant variables describing a book in the prediction 
of book sales is proposed; then several standard data mining models 
for sales forecasting are evaluated so a publishing company 
can deduce and optimize print roll.

The rest of this paper is structured as follows: next, 
Section \ref{sec:soa} presents a comprehensive review of the
approaches found in the bibliography related to the prediction of
sales from product characteristics. 
Then, Section \ref{sec:problem} describes the 
problem of how many books should be printed when a new book is published, 
        % no es el problema de publicación, es el problema de venta
        % de libros sin publicar. Habrá que buscar un nombre - JJ
        %[Pedro] cierto, lo cambio, aunque me ha quedado un nombre muy largo  :)
 followed by Section \ref{sec:methodology} where the
experimental setup and the methodology considered in the study is
presented.  
Section \ref{sec:experiments} reports and analyzes the obtained results with a real data set.
Finally, conclusions and future work are presented in Section
\ref{sec:conclusionsAndFutureWork}. 


%********************************************************************************
\section{Sales forecasting. State of the art}
\label{sec:soa}

% [Pedro] no se encuentra gran cosa sobre predicción de ventas de libros
%  por eso quiero comenzar hablando de la aplicación de métodos
%  de predicción en la industria en general, que sí hay bastante bibliografía.

% In the literature several proposals to perform the prediction of sales in different fields can be found. 
In the last years, different analysis and forecasting methods, such as
regression models \cite{Papalexopoulos1990}, neural networks \cite{Yoo1999} or fuzzy systems \cite{Mastorocostas2001} 
have been applied in different industry sectors, i.e. electricity
consumption, traffic flow or sales forecasting. % ¿Y qué? Esta frase
                                % no aporta nada. La primera frase
                                % tiene que enmarcar el estado del
                                % arte - JJ

Specifically, using time series prediction methods \cite{Chu2003,Brown1959,Winters1960,Box1969,Papalexopoulos1990} 
is perhaps the most used technique to tackle the sales forecasting problems, 
the efficiency of these techniques depends largely on the field of application 
and the problem data as they require a large amount of data for predicting 
sales of new products are not the most suitable for this task \cite{ChingChin2010}.

This is the new book sales forecasting case, for which no historical data 
to make predictions \cite{ChingChin2010,FaderHardie2005,Madsen2008} is available
and only some descriptive variables relative to the new unpublished-book are available.

Methods used to predict book sales have been generally based on experts' 
experience who analyzed data about sales, and taking into account their knowledge 
in industry experience and their perception about trends, could make decisions
on the companies production (how many books should be printed when a new book is published).
This a complex problem as the predictions are influenced by external variables 
that must be taken into account, such as seasonality, promotions or fashions 
that expert managers might subjectively apply \cite{Lapide1999,ChingChin2010,ChernWSF15}.

  %[pedro] sobre la industria editorial no hay trabajos sobre predicción de ventas.
  % Lo habitual ha sido usar el conocimiento de expertos para realizar predicciones 
  %  o aconsejar acerca de la cantidad de libros a imprimir.
  % Lo más parecido que he encontrado son dos trabajos (uno en realidad) de Moon et al. 
  %  sobre "Use Blog Information As Book Sales Prediction":
  %     Moon2010ICSSSM
  %     Moon2010ICEC
Recently, some works propose \cite{Moon2010ICSSSM,Moon2010ICEC} analyzing 
relationships between on-line information and book sales.
Specifically, authors propose using the number of blog references as an indicator of book sales.
Different sales patterns are observed by analyzing data obtained.
In any case, in this research, historical data from published books is used, 
and the proposed methodology can not be usable in the problem of unpublished-books sales prediction.

%
% pasar a contar los casos de la predicción de ventas en la 
% industria de la moda (SThomassey2014) y de nuevos productos (ChingChin2010)
%
% Son problemas muy similares, ya que no hay datos históricos de los nuevos productos,
% al igual que no los hay sobre ventas, y en los que además influyen mucho las variables 
% externas (estacionalidad, modas, fama del author, etc).
% Hay que echar mano de productos similares o simplemente de los datos que describen el nuevo producto.
%

Some authors have faced the problem of forecasting sales of new products using 
different data mining methods \cite{Hammond1990,Chang2009,ChingChin2010,Thomassey2012,Xia2012}. 
Thomassey et al \cite{SThomassey2014} propose using a clustering method and 
decision trees for sales forecasting in textile-appared fashion industry, 
a very similar issue to the new book publishing problem.
The same problem was previously faced by Xia et al \cite{Xia2012} using a 
forecasting method based on extreme learning machine with adaptive metrics of inputs.
Complexity of this problem is due to the lack of historical data, short lifetime 
of the large number of items, and due to the influence of variables such as promotions, 
fashions, or economic environment \cite{Thomassey2012,Xia2012,SThomassey2014}.


  %[Pedro] otro caso muy similar es el paper de ChingChin2010 sobre:
  % New tea product
  % New cosmetic product
  % New soft drink product


  %[Pedro] otro caso a comentar es el paper de Chang2009 sobre: 
  % sales forecasting in printed circuit board industry.


Taking into account the kind of problem we address in this paper, 
a new product sales prediction for which no historical data is available,
the classical forecasting methods based on time series are not adequate. 
Thus, in this paper the relevant variables in the prediction of sales are determined
using data visualization tools and then, standard data mining software 
to predict sales is used to deduce print roll.
In addition, since publishers need models to explain obtained predictions, 
black box forecasting methods may not be suitable for this problem, so 
models based on rules are tested as an alternative.



%********************************************************************************
\section{The problem}
\label{sec:problem}

%Sales forecasting in editorial industry is a very complex problem. 
        %hala, vuelta la burra al trigo - JJ
        %[Pedro] ea, lo quito
There are several difficulties inherent to the new book sales forecasting, such as dealing with limited data, finding adequate forecasting methods, and selecting the best method to use \cite{ChingChin2010}.

The main issue of this paper is to compute forecasting of the sales for new unpublished-books, for which no historical data is available.
Thus, this paper faces the new book publishing problem using different prediction methods and using as inputs the historical sales data related to other yet published books, and some descriptive variables relative to the new unpublished-book.

En el caso de libros ya publicados, se dispone de datos históricos que ayudan a la generación de modelos predictivos. 
Sin embargo, en el caso de nuevos libros no hay datos históricos que ayuden a definir patrones, y sólo ciertos datos descriptivos están disponibles, por lo que no todos los métodos de predicción se pueden utilizar \cite{Madsen2008,ChernWSF15}. 

An additional issue is the dificulty to compare our model with classical forecasting methods, such as time series prediction methods, since books do not have specific sales time series.

A lo largo de esta investigación se colaboró con la empresa Trevenque Editorial \footnote{{\tt http://editorial.trevenque.es}}, una compañía que ofrece sistemas de gestión y servicios para librerías, editoriales y distribuidoras.

La empresa Trevenque, cuyo experto asesoró esta investigación, facilitó un conjunto de datos inicial consistente en 3159 libros. 
En este conjunto, para cada libro se incluye información descriptiva del libro, como son el precio, lugares donde se han puesto a la venta, materia, editorial, ventas, devoluciones, entre otros datos. 
Table \ref{tabla:paramsOrig50} shows the original set of parameters describing each book.

\begin{table}[!h]
\caption{Parameters describing a book, as provided by the company Trevenque.}
\label{tabla:paramsOrig50}
\begin{center}
\begin{tabular}{|c|c|}
\hline 


  %[Pedro] me falta poner ya los nombres traducidos (y usarlos para los SOM)

\begin{minipage}{2.3in} \begin{verbatim}
REFERENCE
AUTHOR
RETAIL PRICE
SUBJECT-MATTER1
SUBJECT-MATTER2
SUBJECT-MATTER3
EDITORIAL
COLLECTION
BOOKBINDING
PRINT-RUN
TOTAL SALES
MALLS SALES
DELEGATES SALES
REST OF SALES
TOTAL SALES FIRST YEAR
MALL SALES FIRST YEAR
DELEGATES SALES FIRST YEAR
REST OF SALES FIRST YEAR
TOTAL DISTRIBUTED
MALLS DISTRIBUTED
DELEGATES DISTRIBUTED
REST OF DISTRIBUTED
TOTAL DISTRIBUTED FIRST YEAR
MALLS DISTRIBUTED FIRST YEAR
DELEGATES DISTRIBUTED FIRST YEAR
\end{verbatim} \end{minipage}     & 

\begin{minipage}{2.3in} \begin{verbatim}
REST OF DISTRIBUTED FIRST YEAR
REPRINTS
NUMBER OF REPRINTS
TOTAL DEVOLUTIONS
MALLS DEVOLUTIONS
DELEGATES DEVOLUTIONS
REST OF DEVOLUTIONS
TOTAL DEVOLUTIONS FIRT YEAR
MALLS DEVOLUTIONS FIRST YEAR
DELEGATES DEVOLUTIONS FIRST YEAR
REST OF DEVOLUTIONS FIRST YEAR
GIFTS
UNITS DISTRIBUTED IN FIRST EDITION
TOTAL SELLING POINTS
MALLS SELLING POINTS
DELEGATES SELLING POINTS
REST OF SELLING POINTS
TOTAL SELLING POINTS FIRST YEAR
MALLS SELLING POINTS FIRST YEAR
DELEGATES SELLING POINTS FIRST YEAR
REST OF SELLING POINTS FIRST YEAR
WEEKS ON SALE
POSITIVE SALE MARKET
MEDIUM SALE MARKET
NEGATIVE SALE MARKET
\end{verbatim} \end{minipage}    \\

\hline
\end{tabular}
\end{center}
\end{table}

En el problema de la predicción de ventas de nuevos libros afectan diversas variables propias del libro en cuestión, como por ejemplo el autor, el precio, la materia o la editorial.

Sin embargo, existen otras variables externas que también afectan a las ventas de un nuevo libro.
Se trata de cuestiones como la estacionalidad, modas o promociones.
Estas otras variables no medibles y que los métodos de predicción clásicos no pueden procesar y que un experto debe tener en cuenta modificando la predicción ofrecida por el método automático. 
Las empresas editoriales suelen finalmente definir reglas o índices para ajustar subjetivamente los resultados de predicción.


%********************************************************************************
\section{Methodology}
\label{sec:methodology}

Hay varias dificultades inherentes al problema de la predicción de ventas de nuevos productos: la limitación en la cantidad de datos disponibles, la aplicación de los diferentes métodos y la elección del más adecuado de ellos.

Además, no existe una metodología estándar para resolver el problema general de la predicción de ventas. 
Habitualmente es necesario un análisis previo de los datos para eliminar las variables que describen el producto y que no aportan información útil para realizar el proceso de predicción.

\begin{figure}[!h] 
\begin{center}
  \epsfig{file=stages.eps,width=7cm}
\caption{\small{Three main stages in this research: data analysis, (2) forecasting methods testing, and (3) subjectively adjusting the obtained results.}}
\label{fig:stages}
\end{center}
\end{figure}

Thus, in this study there are three main stages (see Figure \ref{fig:stages} for details): 
\begin{itemize}
  \item  First, after the editorial company has provided the raw data, taken directly from its database, a selection variables process is carried out. In this stage, an expert sales manager, using the information obtained analyzing the SOM cluster method results, removes some unrelated variables and selects the best variables to be considered in the forecasted model. This task may help to identify leading indicators to be used by the forecasting methods in order to improve the accuracy of future forecasts.

  \item  Then, several forecasting methods has to be tested. In this stage different forecasting methods are used to obtain sales forecasts from the data provided.

  \item  Finally, in some cases, it is necessary a third stage where experienced managers adjust subjectively the results obtained using the forecasting methods. They might manually adjust the forecasting results taking into account their knowledge in industry experience and their perception about trends.

\end{itemize}

%Finally, although different authors have proposed metrics to determine 
%the accuracy of estimates, most companies use metrics based on the analysis 
%of errors, i.e. MAE or RMSE \cite{ChingChin2010,Madsen2008}.

Finally, in the literature different error measures can be found to report 
the results obtained using the prediction methods \cite{ChingChin2010,Madsen2008}. 
Those error measurements are also called error functions or cost functions. 
%One of the most commonly used is the mean absolute error (see equation \ref{eq:MAE}).
In any case, we recommend using widely accepted standard 
equations\footnote{http://www.gepsoft.com/gxpt4kb/Chapter10/Section3/Introduction.htm} 
in order to compare obtained results with those presented in other research 
papers using other methods.
That is why different standard error measurements (Equations \ref{eq:MAE} to \ref{eq:RRSE}), 
implemented in tools like Weka\footnote{http://wiki.pentaho.com/display/DATAMINING} \cite{Witten2011} 
or R\footnote{https://www.otexts.org/fpp/2/5} \cite{Hyndman2013}, are proposed.

Specifically, in order to compute the forecasting errors of the different methods, 
Mean absolute error (MAE), Root mean squared error (RMSE), Relative absolute error (RAE) 
and Root relative squared error (RRSE) have been selected:

\begin{itemize}
  \item \emph{Mean Absolute Error} (MAE):
        \begin{equation}\label{eq:MAE}
            MAE = \frac{1}{n}\sum_{i=1}^n {\mid p_i - o_i\mid}
        \end{equation}

  \item \emph{Root Mean Squared Error} (RMSE):
        \begin{equation}\label{eq:RMSE}
            RMSE = \sqrt{ \frac{1}{n}\sum_{i=1}^n {(p_i - o_i)}^2 }
        \end{equation}

  \item \emph{Relative absolute error} (RAE):
        \begin{equation}\label{eq:RAE}
            RAE = \frac{ \sum_{i=1}^n {\mid p_i - o_i\mid} }{ \sum_{i=1}^n {\mid p_{i-1} - o_i\mid} }
        \end{equation}

  \item \emph{Root relative squared error} (RRSE):
        \begin{equation}\label{eq:RRSE}
            % RRSE = \frac{ \sqrt{ \frac{1}{n}\sum_{i=1}^n {(p_i - o_i)}^2 } }{ \sqrt{ \frac{1}{n}\sum_{i=1}^n {(p_{i-1} - o_i)}^2 } }
            RRSE = \sqrt{ \frac{ \sum_{i=1}^n {(p_i - o_i)}^2  }{ \sum_{i=1}^n {(p_{i-1} - o_i)}^2 }  }
        \end{equation}
\end{itemize}
where $o_i$ is the individual data $i = {1,...,n}$ and $p_i$ is the obtained prediction.


%-------------------------------------------------
\subsection{Data collection and analysis}

Las predicciones suelen basarse en datos históricos de las cuales extraer series temporales y patrones. 
Sin embargo, en el caso de nuevos productos, como es el caso de la edición de nuevos libros, es complicado observar patrones pasados ya que no hay disponibles datos históricos de las ventas \cite{ChingChin2010}.

Además, de todas las variables descriptivas de un nuevo libro, algunas influirán en las predicciones aportando información, mientras que otras pueden resultar superfluas e incluso redundantes.

Así pues, a partir del conjunto inicial de variables, se aplicó el SOM \cite{kohonen1998} con el objetivo de reducir la dimensionalidad de los datos de entrada y elegir un conjunto de variables adecuado.

\textbf{FALTA EXPLICAR EN UN PAR DE PÁRRAFOS QUÉ ES EL SOM DE KOHONEN.} 
This method is usually applied to analyze data as similar items tend to be mapped close together, while those items dissimilar, are mapped apart.
Also, the SOM graph represents and highlight very clearly those regions (clusters) with high training sample concentration and fewer where the samples are scarce.


As stated in Section \ref{sec:problem}, an expert sales manager colaborated in this research in the stage of data analysis.
Thus, the process was as follows:
\begin{itemize}
  \item First, the expert removed superfluous variables, and dimensionality was reduced from 50 to 43 inputs.
  \item Then, the expert, using his knowledge and the information obtained analyzing the SOM results, removed some inputs, reducing the number of variables describing a book from 43 to 13.
  \item The company asked to include the information about \emph{editorial} and \emph{materia}. Thus, in a new iteration, taking into account the expert's advice and the información obtained analyzing the SOM results, the number of inputs was decreased to 7.
  \item In a third step, several forecasting methods were used on the obtained dataset, and the best was choosen to obtain an accurate predicting model.
  \item Finally, some information about the new book, such as \emph{author}, although not included in the obtained models, was taken into account by the expert sales manager to modify the forecasted results. 
\end{itemize}

  %  
  %  El proceso que seguimos, resumido para el paper, es:
  %  
  %  [43 entradas] en 2013-01 vamos a tomar 
  %  	pb_noneg.csv para obtener pb_ventas.csv (es el pb_ventas.arff)
  %  	y hacer el SOM
  %  
  %  [13 entradas] en 2013-02-08 vamos a tomar 
  %  	controlado_reducido.csv.arff (197 líneas)
  %  	pbenero.csv.arff (5656 líneas)
  %  	y hacer el SOM
  %  
  %  [7 entradas; materia editorial] en 2013-02-25 vamos a tomar
  %  	pbRAWtrn.arff
  %  	pbRAWtst.arff
  %  

Más concretamente, en un primer paso, el experto analizó las 50 variables de entrada que describen cada libro para eliminar algunas que estimó como suplerfuas.
Table \ref{tabla:params43} shows the set of variables describing a book (43 total inputs) that the expert manager determined as non-superfluous or non-redundant.

\begin{table}[!h]
\caption{Variables describing a book (43 total inputs), after the expert manager analized the original dataset provided by the company Trevenque to remove some inputs.}
\label{tabla:params43}
\begin{center}
\begin{tabular}{|c|c|}
\hline 

\begin{minipage}{2.3in} \begin{verbatim}
MALLS SELLING POINTS FIRST YEAR
REST OF SALES FIRST YEAR
NEGATIVE SALE MARKET
MALLS DISTRIBUTED FIRST YEAR
TOTAL DEVOLUTIONS
REPRINTS
MALL SALES FIRST YEAR
TOTAL SELLING POINTS FIRST YEAR
UNITS DISTRIBUTED IN FIRST EDITION
PRINT-RUN
NUMBER OF REPRINTS
MALLS DEVOLUTIONS
REST OF SELLING POINTS FIRST YEAR
REST OF SALES
DELEGATES SELLING POINTS
REST OF DEVOLUTIONS
DELEGATES SELLING POINTS FIRST YEAR
POSITIVE SALE MARKET
REST OF DISTRIBUTED FIRST YEAR
REST OF SELLING POINTS
TOTAL DEVOLUTIONS FIRT YEAR
DELEGATES DEVOLUTIONS
\end{verbatim} \end{minipage}     & 

\begin{minipage}{2.3in} \begin{verbatim}
MALLS SALES
TOTAL DISTRIBUTED FIRST YEAR
TOTAL SELLING POINTS
MALLS DISTRIBUTED
DELEGATES DISTRIBUTED FIRST YEAR
MALLS SELLING POINTS
TOTAL SALES FIRST YEAR
MEDIUM SALE MARKET
WEEKS ON SALE
DELEGATES DISTRIBUTED
AUTHOR
DELEGATES SALES FIRST YEAR
GIFTS
MALLS DEVOLUTIONS FIRST YEAR
DELEGATES SALES
REST OF DISTRIBUTED
DELEGATES DEVOLUTIONS FIRST YEAR
TOTAL DISTRIBUTED
REST OF DEVOLUTIONS FIRST YEAR
RETAIL PRICE
TOTAL SALES (output)
\end{verbatim} \end{minipage}    \\

\hline
\end{tabular}
\end{center}
\end{table}

Then, after analizyng the original dataset using the SOM to select the best variables to be considered, and taking into account the knowledge of the company experienced manager, 13 inputs were considered. 
Figure \ref{fig:som43} shows the initial analisys of dataset using the total of 43 descriptive inputs per book.
Table \ref{tabla:params13} shows the set of variables describing a book after the second analisys.
	% esta gráfica no aporta nada, ni la siguiente tampoco. No se puede
	% colocar en un trabajo en revista  cómo ha ido el entrenamiento, sino
	% datos serios de análisis estadístico de las variables. 
	% [Pedro] sí, estoy de acuerdo. Esto va con el ISSUE #6
\begin{figure}[!h] 
\begin{center}
\begin{tabular}{c}
  \epsfig{file=som43vars.eps,width=11cm} \\
  \epsfig{file=som43umatrix.eps,width=5cm}
\end{tabular}
\caption{\small{Initial data analysis, using 43 descriptive variables per book, using SOM.}}
	% Cojollos, ¿qué trabajo os cuesta poner esto en inglés directamente? - JJ
	% [Pedro] sí, si estoy de acuerdo... hay días que me "sale" el texto en inglés,
	% pero hay días que soltar la parrafada en español me resulta más fácil    :/
        % Sería más bien exploratory data analysis o data visualization. Un gráfico no es un análisis. Y pon las cosas cortas en inglés, hombre - JJ
\label{fig:som43}
\end{center}
\end{figure}

\begin{table}[!h]
\caption{Variables that describe every book, 13 in total, after the
  second analysis carried out using the SOM along with the company
  experienced manager % él no hizo el análisis. No cuela con ``along with'' - JJ
to select the best variables to be considered to
  solve the sales forecasting problem.} 
\label{tabla:params13}
\begin{center}
\begin{tabular}{|c|}
\hline 

\begin{minipage}{2.3in} \begin{verbatim}
devolucion_total
reimpresiones
puntos_vta1anio_total
ejemplares_distribuidos_en_novedad
numero_reimpresiones
devolucion1anio_total
colocado1anio_total
puntos_vta_total
semanas_venta
colocado_total
pvp
tirada
venta_total (output)
\end{verbatim} \end{minipage}     \\

\hline
\end{tabular}
\end{center}
\end{table}


Finally, after analizyng the dataset with 13 descriptive inputs per
book, and paying attention to the company experienced manager's
recommendations, 7 inputs were considered; specifically, variables
\emph{editorial} and \emph{materia} were included, while
\emph{devolucion\_total, reimpresiones, puntos\_vta1anio\_total,
  numero\_reimpresiones, devolucion1anio\_total, colocado1anio\_total,
  semanas\_venta, tirada} were discarded.  
	% Hay que aportar datos de por qué se hizo esto. ¿Análisis de planos?
	% ¿Análisis de varianza? - jj
	% [Pedro] En cuanto estén los SOM definitivos lo añadimos. Está relacionado con el ISSUE #6
Figure \ref{fig:som13} shows the initial analisys of dataset using the SOM on the total of 13 descriptive inputs per book.
This, along with the expert manager knowledge determined the final 7 inputs to be considered.
Table \ref{tabla:params7} shows the final set of variables describing a book, taking into account the company experienced manager knowledge.

\begin{figure}[!h] 
\begin{center}
\begin{tabular}{c}
  \epsfig{file=som13vars.eps,width=11cm} \\
  \epsfig{file=som13umatrix.eps,width=5cm}
\end{tabular}
\caption{\small{Análisis de los datos iniciales, usando 13 variables
    descriptivas por libro, utilizando el SOM.}}
% describir de forma más precisa: visualización usando UMatrix de... - JJ
% ¡y usar nombres en inglés para las variables! - JJ
%[pedro] es el siguiente arreglo que le haré mañana al paper    ;)
\label{fig:som13}
\end{center}
\end{figure}

\begin{table}[!h]
\caption{Final set of variables describing a book, taking into account the company experienced manager knowledge, to be considered to solve the sales forecasting problem.}
\label{tabla:params7}
\begin{center}
\begin{tabular}{|c|}
\hline 

\begin{minipage}{2.3in} \begin{verbatim}
ejemplares_distribuidos_en_novedad
puntos_vta_total
colocado_total
pvp
materia
editorial
venta_total (output)
\end{verbatim} \end{minipage}     \\

\hline
\end{tabular}
\end{center}
\end{table}



%-------------------------------------------------
\subsection{Selecting an appropriate forecasting method}

Como se ha comentado anteriormente, existen diferentes métodos de predicción disponibles en la bibliografía, cada uno con una serie de parámetros diferente que pueden influir en los resultados.

Sin embargo, dado que en el caso de nuevos libros sólo ciertos datos descriptivos están disponibles (frente a datos históricos de ventas de libros ya publicados), no todos los métodos predictivos se pueden usar en este problema concreto.

Thus, in this research five forecasting methods, based on the literature review in the introduction \cite{Madsen2008,ChingChin2010,Thomassey2012,Xia2012,SThomassey2014}, have been used. 
Well known forecasting methods implemented in the Weka tool
\cite{Hall2009,Witten2011} have been choosen, as these methods are
widely known, and could be very helpful for practitioners to reproduce
experiments and even to solve similar sales prediction problems using
these methods. % eliminado el pie de página, es mejor usar referencias
               % - JJ

Specifically, following forecasting methods are proposed:
\begin{itemize}

 % weka.classifiers.trees.M5P
 %		http://weka.sourceforge.net/doc.dev/weka/classifiers/trees/M5P.html
 \item M5 Model trees and rules: The original algorithm M5 was proposed by Quinlan \cite{Quinlan1992} and afterwards Wang \cite{Wang1997} made improvements.

 % weka.classifiers.functions.LinearRegression
 %		http://weka.sourceforge.net/doc.dev/weka/classifiers/functions/LinearRegression.html
 \item Linear Regression

 % weka.classifiers.functions.SMOreg
 %		http://weka.sourceforge.net/doc.dev/weka/classifiers/functions/SMOreg.html
 \item Support Vector Machine for Regression (SVM): This algorithm was proposed by Shevade et al \cite{Shevade1999}.

 % weka.classifiers.lazy.IBk 
 %		http://weka.sourceforge.net/doc.dev/weka/classifiers/lazy/IBk.html
 \item K-nearest neighbours classifier (IBk): \cite{Aha1991}

 % weka.classifiers.functions.MultilayerPerceptron
 %		http://weka.sourceforge.net/doc.dev/weka/classifiers/functions/MultilayerPerceptron.html
 \item Multilayer Perceptron

\end{itemize}

The objective is finding the most appropriate forecasting method that minimizes the error between the forecast and the actual sales for each new book published.


%********************************************************************************
\section{Experiments and Results}
\label{sec:experiments}

Una vez que se han determinado los métodos a utilizar y los parámetros de ejecución, se aplicarán a los conjuntos de datos para obtener los modelos de predicción y posteriormente se comprobará su bondad ante datos no vistos previamente.

\textbf{TODO:} % FALTA CONTAR COMO SE HAN PLANIFICADO LAS EJECUCIONES CON LOS DIFERENTES METODOS

  %  
  %  El proceso que seguimos, resumido para el paper, es:
  %  
  %  [43 entradas] en 2013-01 vamos a tomar 
  %  	pb_noneg.csv para obtener pb_ventas.csv (es el pb_ventas.arff)
  %  
  %  [13 entradas] en 2013-02-08 vamos a tomar 
  %  	controlado_reducido.csv.arff (197 líneas)
  %  	pbenero.csv.arff (5656 líneas)
  %  
  %  [7 entradas; materia editorial] en 2013-02-25 vamos a tomar
  %  	pbRAWtrn.arff
  %  	pbRAWtst.arff
  %  

% Mean absolute error MAE
% Root mean squared error RMSE
% Relative absolute error RAE
% Root relative squared error RRSE


  %[pedro] ya están todos los resultados de tabla:results13 para MP5, LR, KNN, SVM y MLP

  % ¿Qué sentido tiene usar los 4 métodos de error? ¿Es que vamos a seleccionar uno? - JJ
  %[pedro] es lo habitual en los trabajos en los que se realizan tareas de predicción
  % en algunos calculan muchos más, pero estos son los más usados. 
Obtained results using the different forecasting methods on the dataset with 13 variables per book can be shown in Table \ref{tabla:results13}:
\begin{table*}[!h]
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline 
 Method 	& Time (sec.) 	  & MAE 			& RMSE 		& RAE 		& RRSE 		\\
\hline
  MP5 		& 2.94 $\pm$ 0.51 	& 65.49 	& 133.73 	& 11.10 	& 9.17 	  \\
\hline
  LR 		  & 0.33 $\pm$ 0.07 	& 100.813 & 257.63 	& 17.09 	& 17.67 	\\
\hline
  SVM 		& 49.10 $\pm$ 8.05	& 52.30	  & 139.45	& 8.87    & 9.56  	\\
\hline
  KNN 		& 0.03 $\pm$ 0.01 	& 198.16 	& 542.93 	& 33.59 	& 37.24 	\\
\hline
  MLP 		& 12.70 $\pm$ 3.08 	& 97.18 $\pm$ 24.74 	& 174.77 $\pm$ 31.50 	& 16.47 $\pm$ 4.19 	& 11.99 $\pm$ 2.16 	\\
\hline
\end{tabular}
\end{center}
\caption{\small{Results (errors and time) obtained using the different
    forecasting methods on the dataset with 13 variables per book.}} 
\label{tabla:results13}
\end{table*}


  %[pedro] ya están los resultados de de tabla:results7 para MP5, LR, KNN, SVM.
  % faltan AUN los de MLP

  Obtained results using the different forecasting methods on the dataset with 7 variables per book can be shown in Table \ref{tabla:results7}:
\begin{table*}[!h]
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline 
 Method   & Time (sec.)     & MAE       & RMSE    & RAE     & RRSE      \\
\hline
  MP5     & 7.39 $\pm$ 1.75   & 117.78   & 260.05  & 18.51   & 17.00  \\
\hline
  LR      & 40.59 $\pm$ 12.94 & 120.29  & 252.91  & 18.91   & 16.54   \\
\hline
  SVM     & 1547.91 $\pm$ 365.55 & 109.30  & 251.16   & 17.18     & 16.42   \\
\hline
  KNN     & 0.02 $\pm$ 0.01   & 293.98  & 1071.52  & 46.21   & 70.06   \\
\hline
  MLP     & 3265.71 $\pm$ 813.37   & 992.97 $\pm$ 0   & 1755.62 $\pm$ 0  & 156.07 $\pm$ 0   & 114.79 $\pm$ 0   \\
\hline
\end{tabular}
\end{center}
\caption{\small{Results (errors and time) obtained using the different forecasting methods on the dataset with 7 variables per book.}}
\label{tabla:results7}
\end{table*}


%********************************************************************************
\section{Conclusions and Future Work}
\label{sec:conclusionsAndFutureWork}

La predicción de ventas en la industria editorial es un problema muy challenging durante los últimos años.

Para resolver este problmea, diferentes técnicas de datamining pueden ser muy útiles, al no haber datos históricos disponibles de las ventas.

La investigación descrita en este trabajo se ha llevado a cabo conjuntamente con una empresa editorial que ha facilitado un conjunto de datos con los que trabajar, así como con la ayuda de un experto en ventas de este campo para validar los resultados obtenidos.
En este sentido, los árboles de decisión resultaron ser un modelo muy adecuado debido a la facilidad para explicar cómo se obtiene dicha predicción a partir de las variables descriptivas del nuevo libro. Esto, frente a los modelos tipo black-box como las ANN fue determinante desde el punto de vista de las necesidades de los expertos y la empresa.

This research provides a new direction in the sales forecasting area using different soft-computing techniques.
Moreover, proposed method could be implemented, not only in the editorial industry, but also in other domains where the specificity of products is similar, and might be of interest to other academic researches and industrial practitioners.

%---------- trabajos futuros

Como trabajos futuros sería interesante comparar las predicciones de los modelos obtenidos con otros basados en métodos de soft-computing, como genetic programming o fuzzy logic.

Por otro lado, puesto que hay algunas características que pueden afectar a la venta de productos de forma significativa, otra forma de mejorar las predicciones de ventas podría ser realizar un estudio en profundidad del efecto de la aplicación de descuentos y promociones.


%********************************************************************************
\section*{Acknowledgements}
This work has been supported in part by PreTEL (PRM Consultores - Trevenque),
SIPESCA (Programa Operativo FEDER de Andalucía 2007-2013), TIN2011-28627-C04-02 and
TIN2014-56494-C4-3-P (Spanish Ministry of Economy and Competitivity),
SPIP2014-01437 (Direcci{\'o}n General de Tr{\'a}fico), PRY142/14
(Fundaci{\'o}n P{\'u}blica Andaluza Centro de Estudios Andaluces en la
IX Convocatoria de Proyectos de Investigaci{\'o}n), and PYR-2014-17
GENIL project (CEI-BIOTIC Granada). 
    % ¿Y el contrato con Trevenque?  - JJ
    %[pedro] añadido 

%********************************************************************************
\bibliographystyle{plain}
\bibliography{refs}

\end{document}
